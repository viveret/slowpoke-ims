@model SlowPokeIMS.Web.ViewModels.IReadOnlyNodeViewModel
@{
    var meta = Model.Doc.Meta;
    string allText = null;
    bool isPDF = false;
    bool isImage = false;
    if (!string.IsNullOrWhiteSpace(meta.ContentType))
    {
        switch (meta.ContentType)
        {
            case "application/pdf":
            isPDF = true;
            break;
            case "text":
            allText = Model.Doc.ReadAllText(Encoding.Unicode, numLines: 5);
            break;
            default:
            if (meta.ContentType.StartsWith("text/"))
            {
                allText = Model.Doc.ReadAllText(Encoding.Unicode, numLines: 5);
            }
            else if (meta.ContentType.StartsWith("image/"))
            {
                isImage = true;
            }
            break;
        }
    }
    var title = meta.Title;
    
    var classSize = (ViewData["classSize"] as string) ?? "";
    var badgeClass = string.IsNullOrEmpty(classSize) ? "s-badge" : $"s-badge s-badge{classSize}";

    var controllerName = ViewData["docController"]?.ToString() ?? Context.Request.RouteValues["controller"]?.ToString();
    var titleHref = !string.IsNullOrEmpty(controllerName) ?
        Url.Action(ViewData["docAction"]?.ToString() ?? "Details", controllerName, new { path = Model.Doc.Path.PathValue })
        :
        "";
}
<div class="s-card">
    <div class="d-grid grid__12 g4">
        <div class="grid--item grid--col11 d-flex">
            <div class="flex--item fl-grow1">
                <a class="fw-bold" href="@titleHref">
                    @if (string.IsNullOrWhiteSpace(title))
                    {
                        <span class="">@Model.Doc.Path</span>
                    }
                    else
                    {
                        <span class="">@title</span>
                        <span class="">@Model.Doc.Path</span>
                    }
                </a>
            </div>
            <span class="flex--item">Size: @string.Format("{0:n0}", Model.Doc.SizeBytes) bytes</span>
        </div>
        <partial name="DocActionsDropdown" />
        <div class="grid--item grid--col12 d-flex fw-wrap g4">
            @if (meta == null)
            {
                <span class="@badgeClass s-badge__danger">Does not have meta file</span>
            }
            else
            {
                @Html.DisplayFor(m => meta)
            }
        </div>
    </div>
</div>